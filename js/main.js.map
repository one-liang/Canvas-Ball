{"version":3,"sources":["main.js"],"names":["canvas","document","getElementById","ctx","getContext","ww","width","window","innerWidth","wh","height","innerHeight","addEventListener","Ball","p","x","y","v","a","r","dragging","prototype","draw","beginPath","save","translate","arc","Math","PI","fillStyle","controls","color","fill","restore","drawV","scale","moveTo","lineTo","strokeStyle","stroke","update","fade","vx","vy","ay","checkBoundary","abs","step","ball","FPS","gui","dat","GUI","add","listen","onChange","value","addColor","init","setInterval","fillRect","setTimeout","getDistance","p1","p2","temp1","temp2","dist","pow","sqrt","console","clear","mousePos","evt","log","nowPos","dx","dy","style","cursor"],"mappings":"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","file":"main.js","sourcesContent":["var canvas = document.getElementById(\"mycanvas\")\r\nvar ctx = canvas.getContext(\"2d\")\r\n\r\nvar ww = canvas.width = window.innerWidth\r\nvar wh = canvas.height = window.innerHeight\r\n// 設寬高滿版\r\nwindow.addEventListener(\"resize\",function(){\r\n  ww = canvas.width = window.innerWidth\r\n  wh = canvas.height = window.innerHeight\r\n})\r\n\r\n// 定義球的類別\r\nvar Ball = function(){\r\n  // 位置\r\n  this.p = {\r\n    x: ww/2,\r\n    y: wh/2\r\n  }\r\n  // 速度\r\n  this.v = {\r\n    x: 10,\r\n    y: 5\r\n  }\r\n  // 加速度\r\n  this.a = {\r\n    x: 0,\r\n    y: 0.8\r\n  }\r\n  // 大小\r\n  this.r = 50\r\n  // 有無被拖曳\r\n  this.dragging = false\r\n}\r\n\r\n// 畫球\r\nBall.prototype.draw = function(){\r\n  ctx.beginPath()\r\n  ctx.save()\r\n  // 移動到這顆球的座標在畫圓\r\n  ctx.translate(this.p.x, this.p.y)\r\n    ctx.arc(0,0,this.r,0,Math.PI*2)\r\n    ctx.fillStyle = controls.color\r\n    ctx.fill()\r\n  ctx.restore()\r\n  \r\n  this.drawV()\r\n}\r\n\r\n// 球的速度線\r\nBall.prototype.drawV = function(){\r\n  ctx.beginPath()\r\n  ctx.save()\r\n  ctx.translate(this.p.x, this.p.y)\r\n  ctx.scale(3,3)\r\n    ctx.moveTo(0,0)\r\n    ctx.lineTo(this.v.x, this.v.y)\r\n    ctx.strokeStyle = \"blue\"\r\n    ctx.stroke()\r\n    \r\n    ctx.beginPath()\r\n    ctx.moveTo(0,0)\r\n    ctx.lineTo(this.v.x, 0)\r\n    ctx.strokeStyle = \"red\"\r\n    ctx.stroke()\r\n  \r\n    ctx.beginPath()\r\n    ctx.moveTo(0,0)\r\n    ctx.lineTo(0, this.v.y)\r\n    ctx.strokeStyle = \"green\"\r\n    ctx.stroke()\r\n  \r\n  ctx.restore()\r\n}\r\n\r\n// 球的更新\r\nBall.prototype.update = function(){\r\n  if(this.dragging==false){\r\n    this.p.x += this.v.x\r\n    this.p.y += this.v.y\r\n\r\n    this.v.x += this.a.x\r\n    this.v.y += this.a.y\r\n\r\n    // 摩擦力\r\n    this.v.x *= controls.fade\r\n    this.v.y *= controls.fade\r\n\r\n    // 新數值更新在控制項上\r\n    controls.vx = this.v.x\r\n    controls.vy = this.v.y\r\n    controls.ay = this.a.y\r\n    \r\n    this.checkBoundary()\r\n  }\r\n}\r\n\r\n// 邊界碰撞\r\nBall.prototype.checkBoundary = function(){\r\n  // 往右的速度+球半徑>視窗寬度(abs=絕對值)\r\n  if(this.p.x+this.r>ww){\r\n    this.v.x = -Math.abs(this.v.x)\r\n  }\r\n  // 往右的速度-球半徑<0\r\n  if(this.p.x-this.r<0){\r\n    this.v.x = Math.abs(this.v.x)\r\n  }\r\n  if(this.p.y+this.r>wh){\r\n    this.v.y = -Math.abs(this.v.y)\r\n  }\r\n  if(this.p.y-this.r<0){\r\n    this.v.y = Math.abs(this.v.y)\r\n  }\r\n}\r\n\r\n// 設控制項\r\nvar controls = {\r\n  vx: 0,\r\n  vy: 0,\r\n  ay: 0.6,\r\n  fade: 0.99,\r\n  update: true,\r\n  color: \"#fff\",\r\n  step: function(){ball.update()},\r\n  FPS: 60\r\n}\r\n// 控制介面dat.gui\r\nvar gui = new dat.GUI()\r\ngui.add(controls,\"vx\",-50,50).listen().onChange(function(value){\r\n  ball.v.x = value\r\n})\r\ngui.add(controls,\"vy\",-50,50).listen().onChange(function(value){\r\n  ball.v.y = value\r\n})\r\ngui.add(controls,\"ay\",-1,1).step(0.01).listen().onChange(function(value){\r\n  ball.a.y = value\r\n})\r\ngui.add(controls,\"fade\",0,1).step(0.01).listen()\r\ngui.add(controls,\"update\")\r\ngui.addColor(controls,\"color\")\r\ngui.add(controls,\"step\")\r\ngui.add(controls,\"FPS\",1,120)\r\n\r\n// 初始化\r\nvar ball;\r\nfunction init(){\r\n  ball = new Ball()\r\n}\r\ninit()\r\n// 更新速度\r\nfunction update(){\r\n  if(controls.update){\r\n    ball.update()\r\n  }\r\n}\r\nsetInterval(update,1000/30)\r\n\r\n// 繪圖\r\nfunction draw(){\r\n  ctx.fillStyle = \"rgba(0,0,0,0.5)\"\r\n  ctx.fillRect(0,0,ww,wh)\r\n  ball.draw()\r\n  // requestAnimationFrame(draw)\r\n  setTimeout(draw,1000/controls.FPS)\r\n}\r\n// requestAnimationFrame(draw)\r\ndraw()\r\n\r\nfunction getDistance(p1,p2){\r\n  // pow 平方 | sqrt 開根號\r\n  let temp1 = p1.x - p2.x\r\n  let temp2 = p1.y - p2.y\r\n  let dist = Math.pow(temp1,2) + Math.pow(temp2,2)\r\n  return Math.sqrt(dist)\r\n}\r\n\r\nconsole.clear()\r\nlet mousePos = { x: 0, y: 0 }\r\ncanvas.addEventListener(\"mousedown\", function(evt){\r\n  mousePos = { x: evt.x, y: evt.y }\r\n  let dist = getDistance(mousePos,ball.p)\r\n  console.log(dist)\r\n  if(dist<ball.r){\r\n    console.log(\"click ball\")\r\n    ball.dragging = true\r\n  }\r\n})\r\ncanvas.addEventListener(\"mousemove\", function(evt){\r\n  let nowPos = { x: evt.x, y: evt.y }\r\n  if( ball.dragging ){\r\n    let dx = nowPos.x - mousePos.x\r\n    let dy = nowPos.y - mousePos.y\r\n    \r\n    ball.p.x += dx\r\n    ball.p.y += dy\r\n    \r\n    ball.v.x = dx\r\n    ball.v.y = dy\r\n  }\r\n  let dist = getDistance(mousePos,ball.p)\r\n  if( dist<ball.r){\r\n    canvas.style.cursor = \"move\"\r\n  }else{\r\n    canvas.style.cursor = \"initial\"\r\n  }\r\n  mousePos = nowPos\r\n})\r\ncanvas.addEventListener(\"mouseup\", function(evt){\r\n  ball.dragging = false\r\n})"]}